{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/kai/KAA/my_profile/frontend/lib/api/client.ts"],"sourcesContent":["import axios, { AxiosInstance, AxiosError, InternalAxiosRequestConfig } from 'axios';\n\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:8080/api';\n\n// 創建 Axios 實例\nexport const apiClient: AxiosInstance = axios.create({\n  baseURL: API_BASE_URL,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n  timeout: 10000,\n});\n\n// Request 攔截器 - 自動添加 Token\napiClient.interceptors.request.use(\n  (config: InternalAxiosRequestConfig) => {\n    if (typeof window !== 'undefined') {\n      const token = localStorage.getItem('access_token');\n      if (token && config.headers) {\n        config.headers.Authorization = `Bearer ${token}`;\n      }\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Response 攔截器 - 處理錯誤和 Token 刷新\napiClient.interceptors.response.use(\n  (response) => {\n    return response;\n  },\n  async (error: AxiosError) => {\n    const originalRequest = error.config as InternalAxiosRequestConfig & { _retry?: boolean };\n\n    // Token 過期，嘗試刷新\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n\n      try {\n        if (typeof window !== 'undefined') {\n          const refreshToken = localStorage.getItem('refresh_token');\n          if (refreshToken) {\n            const response = await axios.post(`${API_BASE_URL}/auth/refresh`, {\n              refresh_token: refreshToken,\n            });\n\n            const { access_token } = response.data.data;\n            localStorage.setItem('access_token', access_token);\n\n            if (originalRequest.headers) {\n              originalRequest.headers.Authorization = `Bearer ${access_token}`;\n            }\n            return apiClient(originalRequest);\n          }\n        }\n      } catch (refreshError) {\n        // Refresh 失敗，清除 Token 並重定向到登入頁\n        if (typeof window !== 'undefined') {\n          localStorage.removeItem('access_token');\n          localStorage.removeItem('refresh_token');\n          window.location.href = '/login';\n        }\n        return Promise.reject(refreshError);\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n"],"names":[],"mappings":";;;;AAEqB;AAFrB;;AAEA,MAAM,eAAe,iEAAwC;AAGtD,MAAM,YAA2B,mJAAK,CAAC,MAAM,CAAC;IACnD,SAAS;IACT,SAAS;QACP,gBAAgB;IAClB;IACA,SAAS;AACX;AAEA,2BAA2B;AAC3B,UAAU,YAAY,CAAC,OAAO,CAAC,GAAG,CAChC,CAAC;IACC,wCAAmC;QACjC,MAAM,QAAQ,aAAa,OAAO,CAAC;QACnC,IAAI,SAAS,OAAO,OAAO,EAAE;YAC3B,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;QAClD;IACF;IACA,OAAO;AACT,GACA,CAAC;IACC,OAAO,QAAQ,MAAM,CAAC;AACxB;AAGF,gCAAgC;AAChC,UAAU,YAAY,CAAC,QAAQ,CAAC,GAAG,CACjC,CAAC;IACC,OAAO;AACT,GACA,OAAO;IACL,MAAM,kBAAkB,MAAM,MAAM;IAEpC,gBAAgB;IAChB,IAAI,MAAM,QAAQ,EAAE,WAAW,OAAO,CAAC,gBAAgB,MAAM,EAAE;QAC7D,gBAAgB,MAAM,GAAG;QAEzB,IAAI;YACF,wCAAmC;gBACjC,MAAM,eAAe,aAAa,OAAO,CAAC;gBAC1C,IAAI,cAAc;oBAChB,MAAM,WAAW,MAAM,mJAAK,CAAC,IAAI,CAAC,GAAG,aAAa,aAAa,CAAC,EAAE;wBAChE,eAAe;oBACjB;oBAEA,MAAM,EAAE,YAAY,EAAE,GAAG,SAAS,IAAI,CAAC,IAAI;oBAC3C,aAAa,OAAO,CAAC,gBAAgB;oBAErC,IAAI,gBAAgB,OAAO,EAAE;wBAC3B,gBAAgB,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,cAAc;oBAClE;oBACA,OAAO,UAAU;gBACnB;YACF;QACF,EAAE,OAAO,cAAc;YACrB,+BAA+B;YAC/B,wCAAmC;gBACjC,aAAa,UAAU,CAAC;gBACxB,aAAa,UAAU,CAAC;gBACxB,OAAO,QAAQ,CAAC,IAAI,GAAG;YACzB;YACA,OAAO,QAAQ,MAAM,CAAC;QACxB;IACF;IAEA,OAAO,QAAQ,MAAM,CAAC;AACxB"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/kai/KAA/my_profile/frontend/lib/auth/token.ts"],"sourcesContent":["import axios from 'axios';\nimport Cookies from 'js-cookie';\n\nconst ACCESS_TOKEN_KEY = 'access_token';\nconst REFRESH_TOKEN_KEY = 'refresh_token';\nconst USER_ROLE_KEY = 'user_role';\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:8080/api';\n\ninterface RefreshResponse {\n  status: 'success';\n  data: {\n    access_token: string;\n    expires_in: number;\n  };\n  message: string;\n}\n\n// 同時設置 localStorage 和 cookies（用於 middleware）\nexport function getAccessToken(): string | null {\n  if (typeof window === 'undefined') return null;\n  return localStorage.getItem(ACCESS_TOKEN_KEY) || Cookies.get(ACCESS_TOKEN_KEY) || null;\n}\n\nexport function setAccessToken(token: string): void {\n  if (typeof window === 'undefined') return;\n  localStorage.setItem(ACCESS_TOKEN_KEY, token);\n  // 設置 cookie（1 小時過期）\n  Cookies.set(ACCESS_TOKEN_KEY, token, { expires: 1 / 24, sameSite: 'lax' });\n}\n\nexport function getRefreshToken(): string | null {\n  if (typeof window === 'undefined') return null;\n  return localStorage.getItem(REFRESH_TOKEN_KEY) || Cookies.get(REFRESH_TOKEN_KEY) || null;\n}\n\nexport function setRefreshToken(token: string): void {\n  if (typeof window === 'undefined') return;\n  localStorage.setItem(REFRESH_TOKEN_KEY, token);\n  // 設置 cookie（7 天過期）\n  Cookies.set(REFRESH_TOKEN_KEY, token, { expires: 7, sameSite: 'lax' });\n}\n\nexport function getUserRole(): string | null {\n  if (typeof window === 'undefined') return null;\n  return localStorage.getItem(USER_ROLE_KEY) || Cookies.get(USER_ROLE_KEY) || null;\n}\n\nexport function setUserRole(role: string): void {\n  if (typeof window === 'undefined') return;\n  localStorage.setItem(USER_ROLE_KEY, role);\n  // 設置 cookie（7 天過期）\n  Cookies.set(USER_ROLE_KEY, role, { expires: 7, sameSite: 'lax' });\n}\n\nexport function clearTokens(): void {\n  if (typeof window === 'undefined') return;\n  localStorage.removeItem(ACCESS_TOKEN_KEY);\n  localStorage.removeItem(REFRESH_TOKEN_KEY);\n  localStorage.removeItem(USER_ROLE_KEY);\n  Cookies.remove(ACCESS_TOKEN_KEY);\n  Cookies.remove(REFRESH_TOKEN_KEY);\n  Cookies.remove(USER_ROLE_KEY);\n}\n\nexport async function refreshAccessToken(): Promise<string | null> {\n  const refreshToken = getRefreshToken();\n  if (!refreshToken) return null;\n\n  try {\n    const response = await axios.post<RefreshResponse>(\n      `${API_BASE_URL}/auth/refresh`,\n      { refresh_token: refreshToken }\n    );\n\n    const newAccessToken = response.data.data.access_token;\n    setAccessToken(newAccessToken);\n    return newAccessToken;\n  } catch (error) {\n    clearTokens();\n    return null;\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAMqB;AANrB;AACA;;;AAEA,MAAM,mBAAmB;AACzB,MAAM,oBAAoB;AAC1B,MAAM,gBAAgB;AACtB,MAAM,eAAe,iEAAwC;AAYtD,SAAS;IACd;;IACA,OAAO,aAAa,OAAO,CAAC,qBAAqB,mKAAO,CAAC,GAAG,CAAC,qBAAqB;AACpF;AAEO,SAAS,eAAe,KAAa;IAC1C;;IACA,aAAa,OAAO,CAAC,kBAAkB;IACvC,oBAAoB;IACpB,mKAAO,CAAC,GAAG,CAAC,kBAAkB,OAAO;QAAE,SAAS,IAAI;QAAI,UAAU;IAAM;AAC1E;AAEO,SAAS;IACd;;IACA,OAAO,aAAa,OAAO,CAAC,sBAAsB,mKAAO,CAAC,GAAG,CAAC,sBAAsB;AACtF;AAEO,SAAS,gBAAgB,KAAa;IAC3C;;IACA,aAAa,OAAO,CAAC,mBAAmB;IACxC,mBAAmB;IACnB,mKAAO,CAAC,GAAG,CAAC,mBAAmB,OAAO;QAAE,SAAS;QAAG,UAAU;IAAM;AACtE;AAEO,SAAS;IACd;;IACA,OAAO,aAAa,OAAO,CAAC,kBAAkB,mKAAO,CAAC,GAAG,CAAC,kBAAkB;AAC9E;AAEO,SAAS,YAAY,IAAY;IACtC;;IACA,aAAa,OAAO,CAAC,eAAe;IACpC,mBAAmB;IACnB,mKAAO,CAAC,GAAG,CAAC,eAAe,MAAM;QAAE,SAAS;QAAG,UAAU;IAAM;AACjE;AAEO,SAAS;IACd;;IACA,aAAa,UAAU,CAAC;IACxB,aAAa,UAAU,CAAC;IACxB,aAAa,UAAU,CAAC;IACxB,mKAAO,CAAC,MAAM,CAAC;IACf,mKAAO,CAAC,MAAM,CAAC;IACf,mKAAO,CAAC,MAAM,CAAC;AACjB;AAEO,eAAe;IACpB,MAAM,eAAe;IACrB,IAAI,CAAC,cAAc,OAAO;IAE1B,IAAI;QACF,MAAM,WAAW,MAAM,mJAAK,CAAC,IAAI,CAC/B,GAAG,aAAa,aAAa,CAAC,EAC9B;YAAE,eAAe;QAAa;QAGhC,MAAM,iBAAiB,SAAS,IAAI,CAAC,IAAI,CAAC,YAAY;QACtD,eAAe;QACf,OAAO;IACT,EAAE,OAAO,OAAO;QACd;QACA,OAAO;IACT;AACF"}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///Users/kai/KAA/my_profile/frontend/lib/api/auth.ts"],"sourcesContent":["import { apiClient } from './client';\nimport { setAccessToken, setRefreshToken, clearTokens } from '@/lib/auth/token';\nimport type {\n  RegisterRequest,\n  LoginRequest,\n  User,\n  ApiResponse,\n  AuthResponse,\n} from '@/types/api';\n\n/**\n * 業務員註冊\n */\nexport async function register(data: RegisterRequest): Promise<ApiResponse<{ user: User; profile: any }>> {\n  const response = await apiClient.post<ApiResponse<{ user: User; profile: any }>>('/auth/register', data);\n  return response.data;\n}\n\n/**\n * 使用者登入\n */\nexport async function login(credentials: LoginRequest): Promise<ApiResponse<AuthResponse>> {\n  const response = await apiClient.post<ApiResponse<AuthResponse>>('/auth/login', credentials);\n\n  // 儲存 Token\n  if (response.data.data) {\n    const { access_token, refresh_token } = response.data.data;\n    setAccessToken(access_token);\n    setRefreshToken(refresh_token);\n  }\n\n  return response.data;\n}\n\n/**\n * 使用者登出\n */\nexport async function logout(): Promise<void> {\n  try {\n    await apiClient.post('/auth/logout');\n  } finally {\n    // 無論成功失敗都清除本地 Token\n    clearTokens();\n  }\n}\n\n/**\n * 取得當前使用者資訊\n */\nexport async function getCurrentUser(): Promise<ApiResponse<User>> {\n  const response = await apiClient.get<ApiResponse<User>>('/auth/me');\n  return response.data;\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAYO,eAAe,SAAS,IAAqB;IAClD,MAAM,WAAW,MAAM,oIAAS,CAAC,IAAI,CAA4C,kBAAkB;IACnG,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe,MAAM,WAAyB;IACnD,MAAM,WAAW,MAAM,oIAAS,CAAC,IAAI,CAA4B,eAAe;IAEhF,WAAW;IACX,IAAI,SAAS,IAAI,CAAC,IAAI,EAAE;QACtB,MAAM,EAAE,YAAY,EAAE,aAAa,EAAE,GAAG,SAAS,IAAI,CAAC,IAAI;QAC1D,IAAA,yIAAc,EAAC;QACf,IAAA,0IAAe,EAAC;IAClB;IAEA,OAAO,SAAS,IAAI;AACtB;AAKO,eAAe;IACpB,IAAI;QACF,MAAM,oIAAS,CAAC,IAAI,CAAC;IACvB,SAAU;QACR,oBAAoB;QACpB,IAAA,sIAAW;IACb;AACF;AAKO,eAAe;IACpB,MAAM,WAAW,MAAM,oIAAS,CAAC,GAAG,CAAoB;IACxD,OAAO,SAAS,IAAI;AACtB"}},
    {"offset": {"line": 224, "column": 0}, "map": {"version":3,"sources":["file:///Users/kai/KAA/my_profile/frontend/lib/query/keys.ts"],"sourcesContent":["import type { SearchParams } from '@/types/api';\n\nexport const queryKeys = {\n  auth: {\n    me: ['auth', 'me'] as const,\n  },\n  search: {\n    salespersons: (params: SearchParams) => ['search', 'salespersons', params] as const,\n    detail: (id: number) => ['search', 'salespersons', id] as const,\n  },\n  salesperson: {\n    profile: ['salesperson', 'profile'] as const,\n    experiences: ['salesperson', 'experiences'] as const,\n    certifications: ['salesperson', 'certifications'] as const,\n    approvalStatus: ['salesperson', 'approval-status'] as const,\n  },\n  admin: {\n    pendingApprovals: ['admin', 'pending-approvals'] as const,\n    users: ['admin', 'users'] as const,\n    statistics: ['admin', 'statistics'] as const,\n    industries: ['admin', 'settings', 'industries'] as const,\n    regions: ['admin', 'settings', 'regions'] as const,\n  },\n} as const;\n"],"names":[],"mappings":";;;;AAEO,MAAM,YAAY;IACvB,MAAM;QACJ,IAAI;YAAC;YAAQ;SAAK;IACpB;IACA,QAAQ;QACN,cAAc,CAAC,SAAyB;gBAAC;gBAAU;gBAAgB;aAAO;QAC1E,QAAQ,CAAC,KAAe;gBAAC;gBAAU;gBAAgB;aAAG;IACxD;IACA,aAAa;QACX,SAAS;YAAC;YAAe;SAAU;QACnC,aAAa;YAAC;YAAe;SAAc;QAC3C,gBAAgB;YAAC;YAAe;SAAiB;QACjD,gBAAgB;YAAC;YAAe;SAAkB;IACpD;IACA,OAAO;QACL,kBAAkB;YAAC;YAAS;SAAoB;QAChD,OAAO;YAAC;YAAS;SAAQ;QACzB,YAAY;YAAC;YAAS;SAAa;QACnC,YAAY;YAAC;YAAS;YAAY;SAAa;QAC/C,SAAS;YAAC;YAAS;YAAY;SAAU;IAC3C;AACF"}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///Users/kai/KAA/my_profile/frontend/hooks/useAuth.ts"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useRouter } from 'next/navigation';\nimport { toast } from 'sonner';\nimport { login, logout, register, getCurrentUser } from '@/lib/api/auth';\nimport { queryKeys } from '@/lib/query/keys';\nimport { setUserRole } from '@/lib/auth/token';\nimport type { LoginRequest, RegisterRequest } from '@/types/api';\n\n/**\n * 取得當前使用者資訊\n */\nexport function useAuth() {\n  return useQuery({\n    queryKey: queryKeys.auth.me,\n    queryFn: async () => {\n      const response = await getCurrentUser();\n      return response.data;\n    },\n    retry: false,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n/**\n * 登入 Mutation\n */\nexport function useLogin() {\n  const router = useRouter();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: login,\n    onSuccess: async (data) => {\n      // 預先設定用戶資料到 cache，避免跳轉後重新獲取\n      const user = data.data?.user;\n      if (user) {\n        queryClient.setQueryData(queryKeys.auth.me, user);\n        // 設置用戶角色到 cookie（用於 middleware）\n        setUserRole(user.role);\n      }\n\n      toast.success(data.message || '登入成功');\n\n      // 根據角色導向對應頁面\n      if (user?.role === 'admin') {\n        router.push('/admin');\n      } else if (user?.role === 'salesperson') {\n        router.push('/dashboard');\n      } else {\n        router.push('/');\n      }\n    },\n    onError: (error: any) => {\n      const message = error.response?.data?.message || '登入失敗';\n      toast.error(message);\n    },\n  });\n}\n\n/**\n * 登出 Mutation\n */\nexport function useLogout() {\n  const router = useRouter();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: logout,\n    onSuccess: () => {\n      // 清除所有快取\n      queryClient.clear();\n\n      toast.success('登出成功');\n      router.push('/login');\n    },\n    onError: () => {\n      // 即使登出失敗也清除本地資料並導向登入頁\n      queryClient.clear();\n      router.push('/login');\n    },\n  });\n}\n\n/**\n * 註冊 Mutation\n */\nexport function useRegister() {\n  const router = useRouter();\n\n  return useMutation({\n    mutationFn: register,\n    onSuccess: (data) => {\n      toast.success(data.message || '註冊成功，請等待管理員審核');\n      router.push('/login');\n    },\n    onError: (error: any) => {\n      const message = error.response?.data?.message || '註冊失敗';\n      const errors = error.response?.data?.errors;\n\n      if (errors) {\n        // 顯示驗證錯誤\n        Object.values(errors).flat().forEach((err) => {\n          toast.error(err as string);\n        });\n      } else {\n        toast.error(message);\n      }\n    },\n  });\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AAMO,SAAS;;IACd,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,oIAAS,CAAC,IAAI,CAAC,EAAE;QAC3B,OAAO;gCAAE;gBACP,MAAM,WAAW,MAAM,IAAA,uIAAc;gBACrC,OAAO,SAAS,IAAI;YACtB;;QACA,OAAO;QACP,WAAW,IAAI,KAAK;IACtB;AACF;GAVgB;;QACP,0LAAQ;;;AAcV,SAAS;;IACd,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACjB,YAAY,8HAAK;QACjB,SAAS;oCAAE,OAAO;gBAChB,4BAA4B;gBAC5B,MAAM,OAAO,KAAK,IAAI,EAAE;gBACxB,IAAI,MAAM;oBACR,YAAY,YAAY,CAAC,oIAAS,CAAC,IAAI,CAAC,EAAE,EAAE;oBAC5C,gCAAgC;oBAChC,IAAA,sIAAW,EAAC,KAAK,IAAI;gBACvB;gBAEA,oJAAK,CAAC,OAAO,CAAC,KAAK,OAAO,IAAI;gBAE9B,aAAa;gBACb,IAAI,MAAM,SAAS,SAAS;oBAC1B,OAAO,IAAI,CAAC;gBACd,OAAO,IAAI,MAAM,SAAS,eAAe;oBACvC,OAAO,IAAI,CAAC;gBACd,OAAO;oBACL,OAAO,IAAI,CAAC;gBACd;YACF;;QACA,OAAO;oCAAE,CAAC;gBACR,MAAM,UAAU,MAAM,QAAQ,EAAE,MAAM,WAAW;gBACjD,oJAAK,CAAC,KAAK,CAAC;YACd;;IACF;AACF;IA/BgB;;QACC,kJAAS;QACJ,2MAAc;QAE3B,gMAAW;;;AAgCb,SAAS;;IACd,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACjB,YAAY,+HAAM;QAClB,SAAS;qCAAE;gBACT,SAAS;gBACT,YAAY,KAAK;gBAEjB,oJAAK,CAAC,OAAO,CAAC;gBACd,OAAO,IAAI,CAAC;YACd;;QACA,OAAO;qCAAE;gBACP,sBAAsB;gBACtB,YAAY,KAAK;gBACjB,OAAO,IAAI,CAAC;YACd;;IACF;AACF;IAnBgB;;QACC,kJAAS;QACJ,2MAAc;QAE3B,gMAAW;;;AAoBb,SAAS;;IACd,MAAM,SAAS,IAAA,kJAAS;IAExB,OAAO,IAAA,gMAAW,EAAC;QACjB,YAAY,iIAAQ;QACpB,SAAS;uCAAE,CAAC;gBACV,oJAAK,CAAC,OAAO,CAAC,KAAK,OAAO,IAAI;gBAC9B,OAAO,IAAI,CAAC;YACd;;QACA,OAAO;uCAAE,CAAC;gBACR,MAAM,UAAU,MAAM,QAAQ,EAAE,MAAM,WAAW;gBACjD,MAAM,SAAS,MAAM,QAAQ,EAAE,MAAM;gBAErC,IAAI,QAAQ;oBACV,SAAS;oBACT,OAAO,MAAM,CAAC,QAAQ,IAAI,GAAG,OAAO;mDAAC,CAAC;4BACpC,oJAAK,CAAC,KAAK,CAAC;wBACd;;gBACF,OAAO;oBACL,oJAAK,CAAC,KAAK,CAAC;gBACd;YACF;;IACF;AACF;IAvBgB;;QACC,kJAAS;QAEjB,gMAAW"}},
    {"offset": {"line": 454, "column": 0}, "map": {"version":3,"sources":["file:///Users/kai/KAA/my_profile/frontend/lib/utils/cn.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\n/**\n * Merge Tailwind CSS classes\n */\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAKO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB"}},
    {"offset": {"line": 472, "column": 0}, "map": {"version":3,"sources":["file:///Users/kai/KAA/my_profile/frontend/components/layout/dashboard-sidebar.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport Link from 'next/link';\nimport { usePathname, useRouter } from 'next/navigation';\nimport { cn } from '@/lib/utils/cn';\nimport { useAuth, useLogout } from '@/hooks/useAuth';\nimport {\n  User,\n  Briefcase,\n  Award,\n  CheckCircle,\n  LogOut,\n  Menu,\n  X,\n  Home,\n} from 'lucide-react';\nimport { Button } from '@/components/ui/button';\n\ninterface NavItem {\n  name: string;\n  href: string;\n  icon: React.ComponentType<{ className?: string }>;\n}\n\nconst navigation: NavItem[] = [\n  { name: '個人資料', href: '/dashboard', icon: User },\n  { name: '工作經驗', href: '/dashboard/experiences', icon: Briefcase },\n  { name: '專業證照', href: '/dashboard/certifications', icon: Award },\n  { name: '審核狀態', href: '/dashboard/approval-status', icon: CheckCircle },\n];\n\nexport function DashboardSidebar() {\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n  const pathname = usePathname();\n  const router = useRouter();\n  const { data: user } = useAuth();\n  const logout = useLogout();\n\n  const handleLogout = () => {\n    logout.mutate(undefined, {\n      onSuccess: () => {\n        router.push('/');\n      },\n    });\n  };\n\n  const closeSidebar = () => {\n    setSidebarOpen(false);\n  };\n\n  return (\n    <>\n      {/* Mobile menu button */}\n      <div className=\"lg:hidden fixed top-0 left-0 right-0 z-40 bg-white border-b border-slate-200 px-4 py-3\">\n        <div className=\"flex items-center justify-between\">\n          <Link href=\"/\" className=\"flex items-center space-x-2\">\n            <div className=\"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-primary-500 to-secondary-500\">\n              <span className=\"text-base font-bold text-white\">Y</span>\n            </div>\n            <span className=\"text-lg font-bold bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent\">\n              YAMU\n            </span>\n          </Link>\n          <button\n            onClick={() => setSidebarOpen(!sidebarOpen)}\n            className=\"p-2 rounded-lg hover:bg-slate-100\"\n          >\n            {sidebarOpen ? <X className=\"h-6 w-6\" /> : <Menu className=\"h-6 w-6\" />}\n          </button>\n        </div>\n      </div>\n\n      {/* Overlay for mobile */}\n      {sidebarOpen && (\n        <div\n          className=\"fixed inset-0 z-40 bg-black/50 lg:hidden\"\n          onClick={closeSidebar}\n        />\n      )}\n\n      {/* Sidebar */}\n      <aside\n        className={cn(\n          'fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-slate-200 transition-transform duration-300 lg:translate-x-0',\n          sidebarOpen ? 'translate-x-0' : '-translate-x-full'\n        )}\n      >\n        <div className=\"flex flex-col h-full\">\n          {/* Logo */}\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-slate-200\">\n            <Link href=\"/\" className=\"flex items-center space-x-2\">\n              <div className=\"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-primary-500 to-secondary-500\">\n                <span className=\"text-xl font-bold text-white\">Y</span>\n              </div>\n              <span className=\"text-2xl font-bold bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent\">\n                YAMU\n              </span>\n            </Link>\n          </div>\n\n          {/* User Info */}\n          <div className=\"px-6 py-4 border-b border-slate-200\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-br from-primary-400 to-secondary-400 text-white font-bold\">\n                {user?.username?.charAt(0).toUpperCase() || 'U'}\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-semibold text-slate-900 truncate\">\n                  {user?.username || '使用者'}\n                </p>\n                <p className=\"text-xs text-slate-500 truncate\">\n                  {user?.email}\n                </p>\n              </div>\n            </div>\n          </div>\n\n          {/* Navigation */}\n          <nav className=\"flex-1 px-3 py-4 space-y-1 overflow-y-auto\">\n            {navigation.map((item) => {\n              const isActive = pathname === item.href;\n              const Icon = item.icon;\n\n              return (\n                <Link\n                  key={item.name}\n                  href={item.href}\n                  onClick={closeSidebar}\n                  className={cn(\n                    'flex items-center px-3 py-2 rounded-lg text-sm font-medium transition-colors',\n                    isActive\n                      ? 'bg-primary-50 text-primary-700'\n                      : 'text-slate-700 hover:bg-slate-100'\n                  )}\n                >\n                  <Icon className={cn('h-5 w-5 mr-3', isActive ? 'text-primary-600' : 'text-slate-400')} />\n                  {item.name}\n                </Link>\n              );\n            })}\n          </nav>\n\n          {/* Bottom Actions */}\n          <div className=\"px-3 py-4 border-t border-slate-200 space-y-2\">\n            <Link\n              href=\"/\"\n              onClick={closeSidebar}\n              className=\"flex items-center px-3 py-2 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-100 transition-colors\"\n            >\n              <Home className=\"h-5 w-5 mr-3 text-slate-400\" />\n              返回首頁\n            </Link>\n            <button\n              onClick={handleLogout}\n              className=\"w-full flex items-center px-3 py-2 rounded-lg text-sm font-medium text-red-700 hover:bg-red-50 transition-colors\"\n            >\n              <LogOut className=\"h-5 w-5 mr-3 text-red-400\" />\n              登出\n            </button>\n          </div>\n        </div>\n      </aside>\n\n      {/* Spacer for mobile menu */}\n      <div className=\"h-14 lg:hidden\" />\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 827, "column": 0}, "map": {"version":3,"sources":["file:///Users/kai/KAA/my_profile/frontend/app/%28dashboard%29/layout.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuth } from '@/hooks/useAuth';\nimport { DashboardSidebar } from '@/components/layout/dashboard-sidebar';\n\nexport default function DashboardLayout({ children }: { children: React.ReactNode }) {\n  const router = useRouter();\n  const { data: user, isLoading, error } = useAuth();\n\n  useEffect(() => {\n    if (!isLoading) {\n      // 未登入，導向登入頁\n      if (error || !user) {\n        router.push('/login');\n        return;\n      }\n\n      // 非業務員角色，導向首頁\n      if (user.role !== 'salesperson') {\n        router.push('/');\n        return;\n      }\n\n      // 帳號未審核通過，顯示提示\n      if (user.status === 'pending') {\n        // 可以導向到一個\"等待審核\"頁面，或顯示提示\n        // 暫時允許訪問以便查看審核狀態\n      }\n    }\n  }, [user, isLoading, error, router]);\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600\"></div>\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'salesperson') {\n    return null;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-slate-50\">\n      <div className=\"flex\">\n        {/* Sidebar */}\n        <DashboardSidebar />\n\n        {/* Main Content */}\n        <main className=\"flex-1 lg:ml-64\">\n          <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n            {children}\n          </div>\n        </main>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAOe,SAAS,gBAAgB,EAAE,QAAQ,EAAiC;;IACjF,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,EAAE,MAAM,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,IAAA,8HAAO;IAEhD,IAAA,0KAAS;qCAAC;YACR,IAAI,CAAC,WAAW;gBACd,YAAY;gBACZ,IAAI,SAAS,CAAC,MAAM;oBAClB,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,cAAc;gBACd,IAAI,KAAK,IAAI,KAAK,eAAe;oBAC/B,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,eAAe;gBACf,IAAI,KAAK,MAAM,KAAK,WAAW;gBAC7B,wBAAwB;gBACxB,iBAAiB;gBACnB;YACF;QACF;oCAAG;QAAC;QAAM;QAAW;QAAO;KAAO;IAEnC,IAAI,WAAW;QACb,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;;;;;;;;;;IAGrB;IAEA,IAAI,CAAC,QAAQ,KAAK,IAAI,KAAK,eAAe;QACxC,OAAO;IACT;IAEA,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BAEb,6LAAC,oKAAgB;;;;;8BAGjB,6LAAC;oBAAK,WAAU;8BACd,cAAA,6LAAC;wBAAI,WAAU;kCACZ;;;;;;;;;;;;;;;;;;;;;;AAMb;GArDwB;;QACP,kJAAS;QACiB,8HAAO;;;KAF1B"}}]
}