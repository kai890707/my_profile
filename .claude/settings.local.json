{
  "permissions": {
    "allow": [
      "Bash(docker-compose ps:*)",
      "Bash(docker-compose exec app composer require firebase/php-jwt)",
      "Bash(docker-compose exec:*)",
      "Bash(docker-compose up:*)",
      "Bash(curl:*)",
      "Bash(python3:*)",
      "Bash(TOKEN=\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJteV9wcm9maWxlX2FwaSIsImlhdCI6MTc2Nzg3MTczNCwiZXhwIjoxNzY3ODc1MzM0LCJzdWIiOjEsImVtYWlsIjoiYWRtaW5AZXhhbXBsZS5jb20iLCJyb2xlIjoiYWRtaW4iLCJ0eXBlIjoiYWNjZXNzIn0.V7fAM6XugUKPhhPw6W166pFz0-lACOCULzTtscO2sEE\")",
      "WebFetch(domain:github.com)",
      "Bash(npm install:*)",
      "Bash(openspec --version:*)",
      "Bash(printf:*)",
      "Bash(openspec init:*)",
      "Bash(ls:*)",
      "Bash(docker exec:*)",
      "Bash(docker restart:*)",
      "Bash(docker logs:*)",
      "Bash(docker-compose restart app)",
      "Bash(docker-compose down:*)",
      "Bash(docker-compose stop:*)",
      "Bash(docker-compose rm:*)",
      "Bash(mkdir:*)",
      "Skill(spec)",
      "Skill(archive)",
      "Bash(cat:*)",
      "Bash(openspec/specs/api/endpoints.md <<'EOF'\n\n---\n\n## Feature: Swagger API Documentation\n\n**Added**: 2026-01-08\n**Change**: swagger-api-documentation\n\n### GET /api/docs\n\n**Description**: 顯示 Swagger UI 互動式 API 文件介面\n\n**Authentication**: Not required\n\n**Authorization**: Public \\(僅開發環境\\)\n\n**Request Parameters**: None\n\n**Response \\(200 OK\\)**: HTML 頁面 \\(Swagger UI\\)\n\n**Response Headers**:\n```\nContent-Type: text/html; charset=UTF-8\n```\n\n**Error Responses**:\n\n**404 Not Found** \\(生產環境\\):\n```json\n{\n    \"status\": \"error\",\n    \"message\": \"Not Found\"\n}\n```\n\n**Business Rules**:\n- BR-001: Environment-Based Visibility\n- BR-002: No Authentication Required\n\n**Example**:\n```bash\n# 開發環境 - 成功\ncurl -X GET http://localhost:8080/api/docs\n\n# 生產環境 - 失敗\ncurl -X GET https://production.example.com/api/docs\n# 返回: 404 Not Found\n```\n\n---\n\n### GET /api/docs/openapi.json\n\n**Description**: 返回 OpenAPI 3.0 規格 JSON，描述所有 API 端點\n\n**Authentication**: Not required\n\n**Authorization**: Public \\(僅開發環境\\)\n\n**Request Parameters**: None\n\n**Response \\(200 OK\\)**:\n```json\n{\n    \"openapi\": \"3.0.0\",\n    \"info\": {\n        \"title\": \"業務推廣系統 API\",\n        \"description\": \"業務員管理與搜尋平台的 RESTful API\",\n        \"version\": \"1.0.0\"\n    },\n    \"servers\": [\n        {\n            \"url\": \"http://localhost:8080\",\n            \"description\": \"開發環境\"\n        }\n    ],\n    \"paths\": { /* 所有 API 端點定義 */ },\n    \"components\": {\n        \"securitySchemes\": {\n            \"bearerAuth\": {\n                \"type\": \"http\",\n                \"scheme\": \"bearer\",\n                \"bearerFormat\": \"JWT\"\n            }\n        }\n    }\n}\n```\n\n**Response Headers**:\n```\nContent-Type: application/json; charset=UTF-8\nCache-Control: no-cache\n```\n\n**Error Responses**:\n\n**404 Not Found** \\(生產環境\\):\n```json\n{\n    \"status\": \"error\",\n    \"message\": \"Not Found\"\n}\n```\n\n**500 Internal Server Error** \\(註解掃描失敗\\):\n```json\n{\n    \"status\": \"error\",\n    \"message\": \"Failed to generate OpenAPI specification\",\n    \"errors\": {\n        \"scan_error\": \"Unable to scan controllers directory\"\n    }\n}\n```\n\n**Business Rules**:\n- BR-001: Environment-Based Visibility\n- BR-003: OpenAPI Specification Validation\n- BR-004: Controller Scanning\n\n**Example**:\n```bash\n# 開發環境 - 成功\ncurl -X GET http://localhost:8080/api/docs/openapi.json\n\n# 測試 Swagger UI 是否正確載入規格\ncurl -X GET http://localhost:8080/api/docs \\\\\n  -H \"Accept: text/html\" | grep \"swagger-ui\"\n```\n\n---\n\nEOF)",
      "Bash(openspec/specs/models/data-models.md <<'EOF'\n\n---\n\n## Feature: Swagger API Documentation\n\n**Added**: 2026-01-08\n**Change**: swagger-api-documentation\n\n### No Database Changes\n\n本功能不需要新增資料表，Swagger API 文件是基於現有 Controller 註解動態生成的文件系統。\n\n### Configuration Structure\n\n#### SwaggerController Class\n\n**File**: `app/Controllers/Api/SwaggerController.php`\n\n**Purpose**: 提供 Swagger UI 介面和 OpenAPI JSON 規格端點\n\n**Class Properties**:\n| Property | Type | Description |\n|----------|------|-------------|\n| $format | string | 回應格式（預設 json） |\n| $controllersPath | string | Controller 掃描路徑 |\n| $enabled | bool | Swagger 是否啟用 |\n\n**Class Methods**:\n| Method | Visibility | Return Type | Description |\n|--------|-----------|-------------|-------------|\n| __construct\\(\\) | public | void | 初始化 Controller，設定掃描路徑 |\n| index\\(\\) | public | Response | 顯示 Swagger UI HTML |\n| json\\(\\) | public | Response | 返回 OpenAPI JSON |\n| getSwaggerUI\\(\\) | protected | string | 生成 Swagger UI HTML 內容 |\n\n#### Environment Variables\n\n**File**: `.env`\n\n| Variable | Type | Default | Description |\n|----------|------|---------|-------------|\n| SWAGGER_ENABLED | boolean | true | 是否啟用 Swagger UI |\n| SWAGGER_OPENAPI_VERSION | string | 3.0.0 | OpenAPI 規格版本 |\n| SWAGGER_API_TITLE | string | API Documentation | API 文件標題 |\n| SWAGGER_API_VERSION | string | 1.0.0 | API 版本號 |\n| SWAGGER_UI_DEEP_LINKING | boolean | true | 是否啟用深度連結 |\n| SWAGGER_CACHE_ENABLED | boolean | false | 是否快取 OpenAPI JSON |\n\n#### Dependencies\n\n**Composer**: `zircote/swagger-php: ^4.0`\n\n---\n\nEOF)",
      "Bash(tree:*)",
      "Skill(develop)",
      "Bash(npx create-next-app@latest frontend --typescript --tailwind --app --no-src-dir --import-alias=\"@/*\" --use-npm)",
      "Bash(npx create-next-app:*)",
      "Bash(npm cache clean:*)",
      "Bash(sudo chown:*)",
      "Bash(npm run build:*)",
      "Bash(npm run dev:*)",
      "Bash(npm test:*)",
      "Bash(find:*)",
      "Bash(lsof:*)",
      "Bash(TOKEN=\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJteV9wcm9maWxlX2FwaSIsImlhdCI6MTc2Nzk0MzY5NywiZXhwIjoxNzY3OTQ3Mjk3LCJzdWIiOjIsImVtYWlsIjoic2FsZXNwZXJzb25AZXhhbXBsZS5jb20iLCJyb2xlIjoic2FsZXNwZXJzb24iLCJ0eXBlIjoiYWNjZXNzIn0.zwjlBmkOUffclWFUNPbE8Vyl7cCfbHzJqTWOVwWgleE\" curl -X GET http://localhost:8080/api/salesperson/profile -H \"Authorization: Bearer $TOKEN\" -s)",
      "Bash(TOKEN=\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJteV9wcm9maWxlX2FwaSIsImlhdCI6MTc2Nzk0MzY5NywiZXhwIjoxNzY3OTQ3Mjk3LCJzdWIiOjIsImVtYWlsIjoic2FsZXNwZXJzb25AZXhhbXBsZS5jb20iLCJyb2xlIjoic2FsZXNwZXJzb24iLCJ0eXBlIjoiYWNjZXNzIn0.zwjlBmkOUffclWFUNPbE8Vyl7cCfbHzJqTWOVwWgleE\")",
      "Bash(chmod:*)",
      "Bash(/Users/kai/KAA/my_profile/frontend/test_all.sh)",
      "Bash(bash:*)",
      "Bash(git add:*)"
    ]
  }
}
